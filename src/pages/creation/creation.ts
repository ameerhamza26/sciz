import { Component } from '@angular/core';
import { NavController, NavParams,ActionSheetController,LoadingController,AlertController  } from 'ionic-angular';
import { Camera } from '@ionic-native/camera';

import {AppSettings} from '../../providers/app-settings';
import {DataService} from '../../providers/data-service';
import { UserService } from '../../providers/user-service';

import {Creation} from '../../models/creation-model';
import {Like} from '../../models/like-model';

import { ChatPage } from '../chat/chat';
import { ProfilePage } from '../profile/profile';

import { UserProfilePage } from '../user-profile/user-profile';

import { PaymentPage } from '../payment/payment';
import {SocialShareProvider} from "../../providers/social-share/social-share";
import {Post} from "../../models/post-model";
import {ErrorHandlerProvider} from "../../providers/error-handler/error-handler";
import {Tag} from "../../models/tag-model";



/**
 * Generated class for the CreationPage page.
 *
 * See http://ionicframework.com/docs/components/#navigation for more info
 * on Ionic pages and navigation.
 */

@Component({
  selector: 'page-creation',
  templateUrl: 'creation.html',
})
export class CreationPage {

  loading:any;
  alert:any;

  apiUrl = this.appSettings.getApiURl();
  originalImage:any;
  creation:any;
  creationCode:any;
  editing:any = false;
  creating:any = false;
  liked:any=false;
  imageUpdated:any=false;
  user:any;
  defaultImage = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABkAAAAZACAYAAAAhDI6nAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4QgLADkhtFAzowAAIABJREFUeNrs2UENwlAQRdEpwQ4OsII6rOAAQUVCm7Bp7j9HweTN8m4zsw8AAAAAAEDIzQQAAAAAAECNAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAAAAAAAECOAAIAAAAAAOQIIAAAAAAAQI4AAgAAAAAA5AggAAAAAABAjgACAAAAAADkCCAA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e1x77bUxe/bsqNVqLhAAAGgyAhAAACCyLItqtRqf+uQl0dHRMaZjN2/eHO8+99y4+uqrG/b8rr766vjlX/7l2Lx585iOmzt3blx22aUxMjISWWaPDQAAaCYCEAAAIEaGR+JjF38kDj547piOW7x4cZz65rfEv3372w1/jrfffnu85S1vicWLF4/puDPOOCM+/OEPxcaNG10oAADQRAQgAADQ4oaGhuLMt50RZ531tjEd98QTT8SZbz87Hn34oaY514ceeijefvbZ8cQYl+m66KKL4qST3hQjIyMuGAAAaBICEAAAaGFpmsbs2bPjfee9d0zHLVu2LM5517vjuSXPNt05L3n22Xj3uefGsmXL6j6mWCzGpz71KUthAQBAExGAAABACxsYHIzz3vue2G+/fes+Znh4ON7zvvNj2bOLm/a8Fz/zTPzqr/5qDA8P133MscceG+9+97ticHDQhQMAAE1AAAIAAC2qWq3G0a9+dbzjHWeP6bhfu+AD8eD99zX9+f/4xz+OCz/4wTEd8zu/8ztxyCGHRK1WcwEBAECDE4AAAEAL2r6M0wUX/PqYjrvqC1fHt/7ln3NTh6/fdltcc801dbefPXt2/MZv/HoMDAy4iAAAoMEJQAAAoAXVarWYN++wOOGE4+s+5t57743PXrEgd7W4/PLL49577627/dlnnx1z5841CwQAABqcAAQAAFpQpVKJX/vV88d0zMd+9//mth6/9/t/UHfbWbNmxQUXXGAvEAAAaHACEAAAaDHVajWOPfa1cdxxx9Z9zJevuy4eu//Hua3JfQv/N6677rq627/vfedFsVjcsZQYAADQeAQgAADQYkZGRuLU/3NKtLe319W+v78/Pnvl53Nfl899/qro7++vq22pVIrzzz8/hoaGXFAAANCgBCAAANBCsiyLJEnilFNOrvuYL/zJn8bAxg25r82mDS/EtddeW3f7t7/9rCgUzAIBAIBGJQABAIAWUqlU4/TT3xy9vb11tq/E9Tfc0DL1+fJXro9KpVJX21/4hV+II4443GboAADQoAQgAADQQrIsjZPe9Ka621/7l38dWzZtbJn69G/cEDfddFNdbZMkibPOOiuGh4ddWAAA0IAEIAAA0CK2Ln9ViGOPrX/z87//h39ouTrd9Pdfq7vtaaedFtVq1cUFAAANSAACAAAtIk3TOPTQQ6K7u6uu9g8/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AAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2BAgAAAAAALAjQAAAAAAAgB0BAgAAAAAA7AgQAAAAAABgR4AAAAAAAAA7AgQAAAAAANgRIAAAAAAAwI4AAQAAAAAAdgQIAAAAAACwI0AAAAAAAIAdAQIAAAAAAOwIEAAAAAAAYEeAAAAAAAAAOwIEAAAAAADYESAAAAAAAMCOAAEAAAAAAHYECAAAAAAAsCNAAAAAAACAHQECAAAAAADsCBAAAAAAAGBHgAAAAAAAADsCBAAAAAAA2BEgAAAAAADAjgABAAAAAAB2AjvTnYNFYMkPAAAAAElFTkSuQmCC";

  constructor(public navCtrl: NavController, public navParams: NavParams,public dataService:DataService, public actionSheetCtrl:ActionSheetController,private camera: Camera,public appSettings:AppSettings,public loadingCtrl: LoadingController,private alertCtrl: AlertController,private socialShare:SocialShareProvider,private errorHandler: ErrorHandlerProvider, public userService: UserService) {

    if(navParams.get('editing')){
      // edit post mode
      this.editing = navParams.get('editing');
      this.user = this.dataService.me;
    }

    if(navParams.get('creating')){
      // edit post mode
      this.creating = navParams.get('creating');
      this.user = this.dataService.me;
      this.createNew(this.user);
    }

    if(navParams.get('creation')){
      // view selected post mode
      this.creation = navParams.get('creation');
      console.log(this.creation.code);
      this.originalImage = this.creation.image;
      this.checkLiked();
    }

  }

  ionViewDidLoad() {
    console.log('ionViewDidLoad CreationPage');
  }

  createNew(user){

  //generate post code and create new empty post
    var code = "";
    var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

    for (var i = 0; i < 60; i++) {
      code += possible.charAt(Math.floor(Math.random() * possible.length));
    }

    this.creationCode = 'creation' + code;

    this.creation = new Creation('',this.creationCode,user.id,'type',this.defaultImage,'title','long description',true,'price');
  }


  getPicture() {

    let actionSheet = this.actionSheetCtrl.create({
      title: 'Select Image Source',
      buttons: [
        {
          text: 'Load from Library',
          handler: () => {
            this.takePicture(this.camera.PictureSourceType.PHOTOLIBRARY);

          }
        },
        {
          text: 'Use Camera',
          handler: () => {
            this.takePicture(this.camera.PictureSourceType.CAMERA);

          }
        },
        {
          text: 'Cancel',
          role: 'cancel'
        }
      ]
    });
    actionSheet.present();


  }

  takePicture(sourceType) {

    let tempImage:any;

    this.imageUpdated = true;

    // Get the data of an image
    this.camera.getPicture({
      destinationType: this.camera.DestinationType.DATA_URL,
      sourceType: sourceType,
      quality:70
    }).then((imageData) => {
      // imageData is a base64 encoded string
      tempImage = "data:image/png;base64," + imageData;
      tempImage = tempImage.replace(/(\r\n|\n|\r)/gm,"");
      this.creation.image = tempImage;
      this.creation.imageUrl = tempImage;
      //newPost.image = 'images/1.jpg';

    }, (err) => {
      console.log('Error while selecting image.');
    });


  }

  viewOptions(){
    console.log(this.userService.user.code);
    console.log(this.creation);

    //if (this.userService.user.userCode != this.creation.userCode)
    if (this.userService.user.id == this.creation.account_id){
    let creator =  this.dataService.users.filter(item => item.id == this.creation.account_id)[0];
      let actionSheet = this.actionSheetCtrl.create({
        title: 'Options',
        buttons: [
          {
            text: 'View Profile',
            handler: () => {

              this.navCtrl.setRoot(UserProfilePage,{
                view:'service'
              });

              this.navCtrl.parent.select(2);

            }
          },
          {
            text: 'Cancel',
            role: 'cancel'
          }
        ]
      });
      actionSheet.present();
    }

    else if (this.creation.availability == 0) {
      let creator =  this.dataService.users.filter(item => item.id == this.creation.account_id)[0];
      console.log(creator)
      let actionSheet = this.actionSheetCtrl.create({
        title: 'Options',
        buttons: [
          {
            text: 'Message',
            handler: () => {
              console.log('message');
              console.log('message');
              this.navCtrl.push(ChatPage,{
                userCode:creator.code,
                view:'service'
              });

            }
          },
          {
            text: 'Visit Profile',
            handler: () => {

              this.navCtrl.push(ProfilePage,{
                userCode:creator.code,
                view:'service'
              });

            }
          },
          {
            text: 'Cancel',
            role: 'cancel'
          }
        ]
      });
      actionSheet.present();
    }

    else {
      let creator =  this.dataService.users.filter(item => item.id == this.creation.account_id)[0];
      let actionSheet = this.actionSheetCtrl.create({
        title: 'Options',
        buttons: [
          {
            text: 'Message',
            handler: () => {
              console.log('message');
              console.log('message');
              this.navCtrl.push(ChatPage,{
                userCode:creator.code,
                view:'service'
              });

            }
          },
          {
            text: 'Visit Profile',
            handler: () => {

              this.navCtrl.push(ProfilePage,{
                userCode:creator.code,
                view:'service'
              });

            }
          },
          {
            text: 'Purchase Item',
            handler: () => {

              this.navCtrl.push(PaymentPage,{
                payload:this.creation,
                view:'service'
              });

            }
          },
          {
            text: 'Cancel',
            role: 'cancel'
          }
        ]
      });
      actionSheet.present();
    }

  }



  checkLiked(){
    // check if you have liked the selected post previously
  console.log( this.creation.code);
    if(this.dataService.likes.filter(item => item.creationCode == 'creation'+this.creation.id).length > 0){
      let reLikedCreation = this.dataService.likes.filter(item => item.creationCode == 'creation'+this.creation.id)[0];

      console.log('liked');
      this.liked = reLikedCreation.liked;
    }else{
      console.log('not liked');
      this.liked = false;
    }
  }

  like(){
    //like post, add to likes
      console.log(this.creation.code);
    if(this.dataService.likes.filter(item => item.creationCode == 'creation'+this.creation.id).length > 0){
      let reLikedCreation = this.dataService.likes.filter(item => item.creationCode == 'creation'+this.creation.id)[0];
      reLikedCreation.liked = true;
      //update database
    }else{
      let likedCreation = new Like ('',this.dataService.me.id,'creation'+this.creation.id,true,this.creation.imageUrl);
      this.dataService.likes.splice(0,0,likedCreation);
      this.dataService.saveLike(likedCreation);
      //save like
    }

    this.checkLiked();
  }

  save(){
// save post

    if ( (this.creation.price.charAt(0) != "N") && (this.creation.price.charAt(0) != "£") && (this.creation.price.charAt(0) != "$") && (this.creation.price.charAt(0) != "€") ){
      this.presentAlert('Error','Invalid price format. Format should be (£15 | $45 | N5000)');
    }

    else if (isNaN(this.creation.price.substring(1,this.creation.price.length))){
      this.presentAlert('Error','Invalid price format. Format should be (£15 | $45 | N5000)');
    }

    else {

    this.showLoading('Saving ..');

      this.dataService.saveImage(this.creation.image,"item"+this.dataService.me.id + "-" + Date.now()).subscribe(data =>{

        try{
          if(data.message == "Successful"){

            this.creation.image= data.imageName;

            this.dataService.saveCreation(this.creation).subscribe(data =>{

              if(data.message == "Successful"){
                if(this.dataService.me.type2 == "Illustrator"){ // tag himself
                  var tag = new Tag(0,data.insertID,this.dataService.me.id);
                  this.dataService.tagInspiration(tag);
                }
                this.dataService.reloadCreations().subscribe(data =>{

                  if(data.status){
                      for(let creation of data.result) {

                          let image = creation.image;
                          creation.image = image;
                          this.dataService.creations.push(creation);

                      }
                      this.loading.dismissAll();
                      console.log("POP");
                      this.navCtrl.pop();
                  }
                  else
                  {
                      this.errorHandler.throwError(ErrorHandlerProvider.MESSAGES.error.creation[1].title,ErrorHandlerProvider.MESSAGES.error.creation[1].msg);
                  }
                });

              }else{
               // this.loading.dismissAll();
                  this.errorHandler.throwError(ErrorHandlerProvider.MESSAGES.error.creation[0].title,ErrorHandlerProvider.MESSAGES.error.creation[0].msg);
              }
            });

          }else{
            //this.loading.dismissAll();
              this.errorHandler.throwError(ErrorHandlerProvider.MESSAGES.error.image[0].title,ErrorHandlerProvider.MESSAGES.error.image[0].msg);
          }
        } catch(error){
         // this.loading.dismissAll();
          this.presentAlert('Oops','Please try again');
        }
       // this.loading.dismissAll();
      });



    }

  }

  update(){

    //update
    // if image updated update that first then data
    //if only data changed then update


    if ( (this.creation.price.charAt(0) != "N") && (this.creation.price.charAt(0) != "£") && (this.creation.price.charAt(0) != "$") && (this.creation.price.charAt(0) != "€") ){
      this.presentAlert('Error','Invalid price format. Format should be (£15 | $45 | N5000)');
    }

    else if (isNaN(this.creation.price.substring(1,this.creation.price.length))){
      this.presentAlert('Error','Invalid price format. Format should be (£15 | $45 | N5000)');
    }

    else if(this.imageUpdated){

      this.showLoading('Updating Image..');

      this.dataService.saveImage(this.creation.image,"item"+this.dataService.me.id + "-" + Date.now()).subscribe(data =>{


        try{
          if(data.message == "Successful"){

            this.loading.dismissAll();
            this.showLoading('Updating Changes..');
            this.creation.image = data.imageName;
            this.dataService.updateCreation(this.creation).subscribe(data =>{


              if(data.message == "Successful"){

                this.dataService.reloadCreations().subscribe(data =>{

                  if(data.status){
                      for(let creation of data.result) {

                          let image = this.dataService.getImageUrl(creation.image,creation);
                          creation.imageUrl = image;
                          this.dataService.creations.push(creation);

                      }

                      this.loading.dismissAll();
                      console.log("POP2");
                      this.navCtrl.pop();

                  }
                  else {
                      this.errorHandler.throwError(ErrorHandlerProvider.MESSAGES.error.creation[1].title,ErrorHandlerProvider.MESSAGES.error.creation[1].msg);

                  }
                });

              }else{
                this.loading.dismissAll();
                  this.errorHandler.throwError(ErrorHandlerProvider.MESSAGES.error.creation[2].title,ErrorHandlerProvider.MESSAGES.error.creation[2].msg);
              }
            });

          }else{
            this.loading.dismissAll();
              this.errorHandler.throwError(ErrorHandlerProvider.MESSAGES.error.image[1].title,ErrorHandlerProvider.MESSAGES.error.image[1].msg);
          }
        } catch(error){
          this.loading.dismissAll();
            this.errorHandler.throwError(ErrorHandlerProvider.MESSAGES.error.image[1].title,ErrorHandlerProvider.MESSAGES.error.image[1].msg);
        }
      });

    }else{

      this.showLoading('Updating Changes ..');

      this.dataService.updateCreation(this.creation).subscribe(data =>{


        if(data.message == "Successful"){

          this.dataService.reloadCreations().subscribe(data =>{

            if(data.status){
                for(let creation of data.result) {

                    let image = this.dataService.apiUrl + "images/" + creation.image;
                    creation.image = image;
                    this.dataService.creations.push(creation);

                }

                this.loading.dismissAll();
                console.log("POP3");
                this.navCtrl.pop();

            }
            else{
                this.loading.dismissAll();

                this.errorHandler.throwError(ErrorHandlerProvider.MESSAGES.error.creation[1].title,ErrorHandlerProvider.MESSAGES.error.creation[1].msg);

            }


          });

        }else{
          this.loading.dismissAll();
            this.errorHandler.throwError(ErrorHandlerProvider.MESSAGES.error.creation[2].title,ErrorHandlerProvider.MESSAGES.error.creation[2].msg);
            }
      });


    }


  }

  showLoading(message){

    this.loading = this.loadingCtrl.create({
      content: message
    });
    this.loading.present();

    /*setTimeout(() => {
      this.loading.dismiss();
    }, 120000);*/


  }


  presentAlert(title,message) {
    this.alert = this.alertCtrl.create({
      title: title,
      subTitle: message,
      buttons: ['Dismiss']
    });
    this.alert.present();
  }

  goBack(){
    this.navCtrl.pop();
  }

  facebookShare(creation: Creation) {
    this.socialShare.shareItem(creation,'Facebook');
  }
  twitterShare(creation: Creation){
      this.socialShare.shareItem(creation,'Twitter');

  }
  instagramShare(creation: Creation){
      this.socialShare.shareItem(creation,'Instagram');
  }
    whatsappShare(creation: Creation){
        this.socialShare.shareItem(creation,'Whatsapp');
    }
    emailShare(creation: Creation){
        this.socialShare.shareItem(creation,'Email');
    }



}
